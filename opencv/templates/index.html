<html>
  <head>
    <title>Video Streaming Demonstration</title>
  </head>
  <body>
    <h1>Video Streaming Demonstration</h1>
    <img src="/camera">
    <button id="getBounds" disabled>Get Bounds</button>
    <div id="boundsDisp"></div>
    <button id="snapshot">Snapshot</button>
    <div id="snapshotResult"></div>
    <form id="configOptions">
      <input type="range" min="0" max="255" name="threshold" id="thresholdConfig">
      <output name="thresholdOutput"></output>
      <input type="submit" value="Configure">
    </div>
    <script>
      (function () {
        "use strict";

        let configOptions = document.getElementById("configOptions")
        configOptions.addEventListener("input", function (event) {
          let form = document.getElementById("configOptions");
          form.elements["thresholdOutput"].value = form.elements["threshold"].value;
        });
        // console.log(configOptions);
        configOptions.addEventListener("submit", function (event) {
          // console.log(event);
          event.preventDefault();
          let form = document.getElementById("configOptions")
          // console.log(form);
          fetch(
            "/config", {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify({threshold: form.elements["threshold"].value}),
            }
          ).finally(function () {
            // form.reset();
          })
          return false
        });

        let snapshotButton = document.getElementById("snapshot");
        snapshotButton.addEventListener("click", function (event) {
          fetch("/snap", {
            method: "POST"
          }).then(function (response) {
            document.getELementById("snapshotResult").textContent = response.body;
          })
        });

      })();
    </script>
  </body>
</html>